# 动态分区存储管理和动态分页存储管理的模拟实现

## 1、设计目的

内存是计算机系统的核心之一，合理的内存管理策略不仅直接影响内存的利用率，而且对提升系统性能有着重要的作用。通过对内存的动态分区管理过程和动态分页管理过程的模拟实现，掌握动态分区管理中内存分配、回收策略及动态分页管理中请求式分页管理方法，并进一步理解分区管理、分页管理的特点和虚拟内存实现方式。

## 2、设计内容

### （1）模拟实现动态分区管理中内存的分配和回收过程。

对于资源请求表中的要求内存长度，从可用分区表中寻找出合适的空闲区进行分配；分配空闲区之后，更新可用分区表；进程或作业释放内存资源时，应和相邻的空闲区进行链接合并，同时更新可用分区表。要求分别模拟最先适应、最佳适应和最坏适应分配算法。资源请求表、可用分区表等数据结构的定义可参考教材第五章中的结构定义也可自行设计，要求模拟出不同分配算法的分配过程和回收过程并显示（资源请求情况，能否分配，分配前后可用分区表的变化，资源回收请求，回收前后可用分区表的变化等）。

### （2）模拟实现动态分页管理中请求式分页管理的过程。

如果访问的页面在内存，计算出相应的物理地址，如果访问的页面不在内存，产生缺页中断，将所缺页从外存调入，如果内存没有空间需要将内存的一页淘汰，再将所缺页调入，然后计算出相应的物理地址。发生缺页中断时，查找装入新页面的内存块的处理方式采用局部置换算法，即每个作业分得一定的内存块，只能在分得的内存块内查找空闲块（例如一个4页的作业分得2个内存块，只能在这2个内存块中查找空闲块），若无空闲内存块，则从该作业中选择一个页面淘汰出内存，页面淘汰算法采用先进先出算法。页表结构除页号和该页对应的内存块号外，至少还要包括存在标志（该页是否在内存）、磁盘位置（该页的副本在磁盘上的位置）和修改标志（该页是否修改过）。假定内存64KB，每个内存块1024字节，即物理地址中块号6位、块内地址10位；作业最大64KB，即逻辑地址中页号6位、页内地址10位。要求模拟出请求式分页管理过程并显示（作业执行指令，物理地址，是否产生缺页中断，产生缺页中断时页面置换情况，页表的状态变化等）。

例如，某作业的页表如下（系统分配给该作业 4 个内存块）：



| 页号 | 标志 | 内存块号 | 修改标志 | 在磁盘上的位置 |
| -- | -- | ---- | ---- | ------- |
| 0  | 1  | 5    | 0    | 010     |
| 1  | 1  | 8    | 0    | 012     |
| 2  | 1  | 9    | 0    | 013     |
| 3  | 1  | 1    | 0    | 021     |
| 4  | 0  |      | 0    | 022     |
| 5  | 0  |      | 0    | 023     |
| 6  | 0  |      | 0    | 125     |

作业执行的指令序列如下：



| 序号  | 操作      | 页号 | 页内地址 | 序号   | 操作      | 页号 | 页内地址 |
| ----- | --------- | ---- | -------- | ------ | --------- | ---- | -------- |
| （1） | +         | 0    | 072      | （7）  | +         | 4    | 056      |
| （2） | /         | 1    | 050      | （8）  | -         | 5    | 023      |
| （3） | *         | 2    | 015      | （9）  | 存 (save) | 1    | 037      |
| （4） | 存 (save) | 3    | 026      | （10） | +         | 2    | 078      |
| （5） | 取 (load) | 0    | 056      | （11） | -         | 4    | 001      |
| （6） | -         | 6    | 040      | （12） | 存 (save) | 6    | 086      |

则作业执行时每条指令的物理地址和是否发生缺页中断的情况如下：

| 序号 | 物理地址 | 缺页情况 | 序号 | 物理地址 | 缺页情况 |
| ---- | ---- | ---- | ---- | ---- | ---- |
| （1） | 5192 | 不缺页 | （7） | 8248 | 缺页，淘汰第1页 |
| （2） | 8242 | 不缺页 | （8） | 9239 | 缺页，淘汰第2页 |
| （3） | 9231 | 不缺页 | （9） | 1061 | 缺页，淘汰第3页 |
| （4） | 1050 | 不缺页 | （10） | 5198 | 缺页，淘汰第6页 |
| （5） | 5176 | 不缺页 | （11） | 8193 | 不缺页 |
| （6） | 5160 | 缺页，淘汰第0页 | （12） | 8278 | 缺页，淘汰第4页 |

### （3）模拟实现过程要求

使用可视化图形界面进行操作和显示（鼓励采用动画等实时动态方式显示执行过程）。